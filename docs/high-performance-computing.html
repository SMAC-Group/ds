<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical Programming Methods with R</title>
  <meta name="description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical Programming Methods with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://smac-group.github.io/ds/" />
  
  <meta property="og:description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control." />
  <meta name="github-repo" content="smac-group/ds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical Programming Methods with R" />
  
  <meta name="twitter:description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control." />
  

<meta name="author" content="Matthew Beckman, Stéphane Guerrier, Justin Lee, Roberto Molinari &amp; Samuel Orso">


<meta name="date" content="2018-11-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r-packages.html">
<link rel="next" href="website-creation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Programming Methods</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> <code>R</code> and <code>RStudio</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.1.1</b> Getting started with <code>R</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>1.1.2</b> Why <code>R</code>?</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#about-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> About RStudio</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i><b>1.1.4</b> Conventions</a></li>
<li class="chapter" data-level="1.1.5" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>1.1.5</b> Getting help</a></li>
<li class="chapter" data-level="1.1.6" data-path="index.html"><a href="index.html#installing-packages"><i class="fa fa-check"></i><b>1.1.6</b> Installing packages</a></li>
<li class="chapter" data-level="1.1.7" data-path="index.html"><a href="index.html#additional-references"><i class="fa fa-check"></i><b>1.1.7</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#basic-probability-and-statistics-with-r"><i class="fa fa-check"></i><b>1.2</b> Basic Probability and Statistics with <code>R</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#simple-calculations"><i class="fa fa-check"></i><b>1.2.1</b> Simple calculations</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#probability-distributions"><i class="fa fa-check"></i><b>1.2.2</b> Probability Distributions</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#summary-statistics"><i class="fa fa-check"></i><b>1.2.3</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#main-references"><i class="fa fa-check"></i><b>1.3</b> Main References</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.4</b> License</a></li>
</ul></li>
<li class="part"><span><b>I Foundation</b></span></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> RMarkdown</a><ul>
<li><a href="rmarkdown.html#what-is-literate-programming">What is <strong>literate</strong> programming ?</a></li>
<li><a href="rmarkdown.html#what-is-reproducible-research">What is <strong>reproducible</strong> research ?</a></li>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#create-an-r-markdown-file-in-rstudio"><i class="fa fa-check"></i><b>2.1</b> Create an R Markdown file in RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml-metadata"><i class="fa fa-check"></i><b>2.2</b> YAML Metadata</a><ul>
<li class="chapter" data-level="2.2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#subsections"><i class="fa fa-check"></i><b>2.2.1</b> Subsections</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#text"><i class="fa fa-check"></i><b>2.3</b> Text</a><ul>
<li class="chapter" data-level="2.3.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.3.1</b> Headers</a></li>
<li class="chapter" data-level="2.3.2" data-path="rmarkdown.html"><a href="rmarkdown.html#lists"><i class="fa fa-check"></i><b>2.3.2</b> Lists</a></li>
<li class="chapter" data-level="2.3.3" data-path="rmarkdown.html"><a href="rmarkdown.html#hyperlinks"><i class="fa fa-check"></i><b>2.3.3</b> Hyperlinks</a></li>
<li class="chapter" data-level="2.3.4" data-path="rmarkdown.html"><a href="rmarkdown.html#blockquotes"><i class="fa fa-check"></i><b>2.3.4</b> Blockquotes</a></li>
<li class="chapter" data-level="2.3.5" data-path="rmarkdown.html"><a href="rmarkdown.html#pictures"><i class="fa fa-check"></i><b>2.3.5</b> Pictures</a></li>
<li class="chapter" data-level="2.3.6" data-path="rmarkdown.html"><a href="rmarkdown.html#latex"><i class="fa fa-check"></i><b>2.3.6</b> LaTeX</a></li>
<li class="chapter" data-level="2.3.7" data-path="rmarkdown.html"><a href="rmarkdown.html#cross-referencing-sections"><i class="fa fa-check"></i><b>2.3.7</b> Cross-referencing Sections</a></li>
<li class="chapter" data-level="2.3.8" data-path="rmarkdown.html"><a href="rmarkdown.html#citations-and-bibliography"><i class="fa fa-check"></i><b>2.3.8</b> Citations and Bibliography</a></li>
<li class="chapter" data-level="2.3.9" data-path="rmarkdown.html"><a href="rmarkdown.html#tables"><i class="fa fa-check"></i><b>2.3.9</b> Tables</a></li>
<li class="chapter" data-level="2.3.10" data-path="rmarkdown.html"><a href="rmarkdown.html#additional-references-1"><i class="fa fa-check"></i><b>2.3.10</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#code-chunks"><i class="fa fa-check"></i><b>2.4</b> Code Chunks</a><ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#code-chunk-options"><i class="fa fa-check"></i><b>2.4.1</b> Code Chunk Options</a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#comments"><i class="fa fa-check"></i><b>2.4.2</b> Comments</a></li>
<li class="chapter" data-level="2.4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#in-line-r"><i class="fa fa-check"></i><b>2.4.3</b> In-line R</a></li>
<li class="chapter" data-level="2.4.4" data-path="rmarkdown.html"><a href="rmarkdown.html#cache"><i class="fa fa-check"></i><b>2.4.4</b> Cache</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#render-output"><i class="fa fa-check"></i><b>2.5</b> Render Output</a></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#addition-information"><i class="fa fa-check"></i><b>2.6</b> Addition Information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3</b> GitHub</a><ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html#version-control"><i class="fa fa-check"></i><b>3.1</b> Version Control</a></li>
<li class="chapter" data-level="3.2" data-path="github.html"><a href="github.html#git-and-github"><i class="fa fa-check"></i><b>3.2</b> Git and GitHub</a><ul>
<li class="chapter" data-level="3.2.1" data-path="github.html"><a href="github.html#git-setup"><i class="fa fa-check"></i><b>3.2.1</b> Git Setup</a></li>
<li class="chapter" data-level="3.2.2" data-path="github.html"><a href="github.html#github-setup"><i class="fa fa-check"></i><b>3.2.2</b> GitHub Setup</a></li>
<li class="chapter" data-level="3.2.3" data-path="github.html"><a href="github.html#student-developer-pack"><i class="fa fa-check"></i><b>3.2.3</b> Student Developer Pack</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="github.html"><a href="github.html#github-workflow"><i class="fa fa-check"></i><b>3.3</b> GitHub Workflow</a><ul>
<li class="chapter" data-level="3.3.1" data-path="github.html"><a href="github.html#branching"><i class="fa fa-check"></i><b>3.3.1</b> Branching</a></li>
<li class="chapter" data-level="3.3.2" data-path="github.html"><a href="github.html#pull"><i class="fa fa-check"></i><b>3.3.2</b> Pull</a></li>
<li class="chapter" data-level="3.3.3" data-path="github.html"><a href="github.html#commits"><i class="fa fa-check"></i><b>3.3.3</b> Commits</a></li>
<li class="chapter" data-level="3.3.4" data-path="github.html"><a href="github.html#push-or-merge"><i class="fa fa-check"></i><b>3.3.4</b> Push or Merge</a></li>
<li class="chapter" data-level="3.3.5" data-path="github.html"><a href="github.html#merge-conflicts"><i class="fa fa-check"></i><b>3.3.5</b> Merge Conflicts</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="github.html"><a href="github.html#github-workflow-on-command-line-git-bash"><i class="fa fa-check"></i><b>3.4</b> GitHub Workflow on Command Line / Git Bash</a></li>
<li class="chapter" data-level="3.5" data-path="github.html"><a href="github.html#issues"><i class="fa fa-check"></i><b>3.5</b> Issues</a></li>
<li class="chapter" data-level="3.6" data-path="github.html"><a href="github.html#slack-integration"><i class="fa fa-check"></i><b>3.6</b> Slack Integration</a></li>
<li class="chapter" data-level="3.7" data-path="github.html"><a href="github.html#additional-references-2"><i class="fa fa-check"></i><b>3.7</b> Additional References</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to R</b></span></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data.html"><a href="data.html#type"><i class="fa fa-check"></i><b>4.1.1</b> Type</a></li>
<li class="chapter" data-level="4.1.2" data-path="data.html"><a href="data.html#coercion"><i class="fa fa-check"></i><b>4.1.2</b> Coercion</a></li>
<li class="chapter" data-level="4.1.3" data-path="data.html"><a href="data.html#subsetting"><i class="fa fa-check"></i><b>4.1.3</b> Subsetting</a></li>
<li class="chapter" data-level="4.1.4" data-path="data.html"><a href="data.html#vectattr"><i class="fa fa-check"></i><b>4.1.4</b> Attributes</a></li>
<li class="chapter" data-level="4.1.5" data-path="data.html"><a href="data.html#addlab"><i class="fa fa-check"></i><b>4.1.5</b> Adding Labels</a></li>
<li class="chapter" data-level="4.1.6" data-path="data.html"><a href="data.html#working-with-dates"><i class="fa fa-check"></i><b>4.1.6</b> Working with Dates</a></li>
<li class="chapter" data-level="4.1.7" data-path="data.html"><a href="data.html#useful-functions-with-vectors"><i class="fa fa-check"></i><b>4.1.7</b> Useful Functions with Vectors</a></li>
<li class="chapter" data-level="4.1.8" data-path="data.html"><a href="data.html#creating-sequences"><i class="fa fa-check"></i><b>4.1.8</b> Creating sequences</a></li>
<li class="chapter" data-level="4.1.9" data-path="data.html"><a href="data.html#example-apple-stock-price"><i class="fa fa-check"></i><b>4.1.9</b> Example: Apple Stock Price</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#matrices"><i class="fa fa-check"></i><b>4.2</b> Matrices</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#subsetting-1"><i class="fa fa-check"></i><b>4.2.1</b> Subsetting</a></li>
<li class="chapter" data-level="4.2.2" data-path="data.html"><a href="data.html#matrix-operators-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Matrix Operators in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="data.html"><a href="data.html#example-summary-statistics-with-matrix-notation"><i class="fa fa-check"></i><b>4.2.3</b> Example: Summary Statistics with Matrix Notation</a></li>
<li class="chapter" data-level="4.2.4" data-path="data.html"><a href="data.html#example-portfolio-optimization"><i class="fa fa-check"></i><b>4.2.4</b> Example: Portfolio Optimization</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#array"><i class="fa fa-check"></i><b>4.3</b> Array</a></li>
<li class="chapter" data-level="4.4" data-path="data.html"><a href="data.html#list"><i class="fa fa-check"></i><b>4.4</b> List</a></li>
<li class="chapter" data-level="4.5" data-path="data.html"><a href="data.html#dataframe"><i class="fa fa-check"></i><b>4.5</b> Dataframe</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data.html"><a href="data.html#combination"><i class="fa fa-check"></i><b>4.5.1</b> Combination</a></li>
<li class="chapter" data-level="4.5.2" data-path="data.html"><a href="data.html#subsetting-2"><i class="fa fa-check"></i><b>4.5.2</b> Subsetting</a></li>
<li class="chapter" data-level="4.5.3" data-path="data.html"><a href="data.html#example-maps"><i class="fa fa-check"></i><b>4.5.3</b> Example: Maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>5</b> Control Structures</a><ul>
<li class="chapter" data-level="5.1" data-path="control.html"><a href="control.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="control.html"><a href="control.html#selcontrostat"><i class="fa fa-check"></i><b>5.2</b> Selection control statements</a><ul>
<li class="chapter" data-level="5.2.1" data-path="control.html"><a href="control.html#sec_logical"><i class="fa fa-check"></i><b>5.2.1</b> Logical Operators</a></li>
<li class="chapter" data-level="5.2.2" data-path="control.html"><a href="control.html#selection-operators"><i class="fa fa-check"></i><b>5.2.2</b> Selection Operators</a></li>
<li class="chapter" data-level="5.2.3" data-path="control.html"><a href="control.html#iter_cont_stat"><i class="fa fa-check"></i><b>5.2.3</b> Iterative Control Statements</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="control.html"><a href="control.html#example-the-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Example: The Bootstrap</a></li>
<li class="chapter" data-level="5.4" data-path="control.html"><a href="control.html#example-random-walk"><i class="fa fa-check"></i><b>5.4</b> Example: Random Walk</a></li>
<li class="chapter" data-level="5.5" data-path="control.html"><a href="control.html#example-monte-carlo-integration"><i class="fa fa-check"></i><b>5.5</b> Example: Monte-Carlo Integration</a><ul>
<li class="chapter" data-level="5.5.1" data-path="control.html"><a href="control.html#introduction-2"><i class="fa fa-check"></i><b>5.5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.5.2" data-path="control.html"><a href="control.html#implementation"><i class="fa fa-check"></i><b>5.5.2</b> Implementation</a></li>
<li class="chapter" data-level="5.5.3" data-path="control.html"><a href="control.html#application-to-the-normal-distribution"><i class="fa fa-check"></i><b>5.5.3</b> Application to the Normal Distribution</a></li>
<li class="chapter" data-level="5.5.4" data-path="control.html"><a href="control.html#application-to-nonelementary-integrals"><i class="fa fa-check"></i><b>5.5.4</b> Application to Nonelementary Integrals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#r-functions"><i class="fa fa-check"></i><b>6.1</b> R functions</a></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#creating-functions-in-r"><i class="fa fa-check"></i><b>6.2</b> Creating functions in R</a><ul>
<li class="chapter" data-level="6.2.1" data-path="functions.html"><a href="functions.html#function-arguments"><i class="fa fa-check"></i><b>6.2.1</b> Function arguments</a></li>
<li class="chapter" data-level="6.2.2" data-path="functions.html"><a href="functions.html#function-body"><i class="fa fa-check"></i><b>6.2.2</b> Function body</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#function-environment"><i class="fa fa-check"></i><b>6.3</b> Function environment</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#example-continued-least-squares-function"><i class="fa fa-check"></i><b>6.4</b> Example (continued): Least-squares function</a></li>
</ul></li>
<li class="part"><span><b>III Extending</b></span></li>
<li class="chapter" data-level="7" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html"><i class="fa fa-check"></i><b>7</b> Shiny Web Applications</a><ul>
<li class="chapter" data-level="7.1" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-1.-defining-the-r-code-in-the-backend-of-the-shiny-app"><i class="fa fa-check"></i><b>7.2</b> Step 1. Defining the R Code in the backend of the Shiny app</a></li>
<li class="chapter" data-level="7.3" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-2-user-interface-ui-frontend"><i class="fa fa-check"></i><b>7.3</b> Step 2: User Interface (UI) / Frontend</a><ul>
<li class="chapter" data-level="" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#content-creation"><i class="fa fa-check"></i>Content Creation</a></li>
<li class="chapter" data-level="" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#input-controls"><i class="fa fa-check"></i>Input Controls</a></li>
<li class="chapter" data-level="" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#output-render-controls"><i class="fa fa-check"></i>Output Render Controls</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-3-implementing-the-backend-server"><i class="fa fa-check"></i><b>7.4</b> Step 3: Implementing the backend (server)</a></li>
<li class="chapter" data-level="7.5" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-4-connecting-frontend-and-backend"><i class="fa fa-check"></i><b>7.5</b> Step 4: Connecting frontend and backend</a></li>
<li class="chapter" data-level="7.6" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-5-customize"><i class="fa fa-check"></i><b>7.6</b> Step 5: Customize</a></li>
<li class="chapter" data-level="7.7" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#example-monte-carlo-integration-1"><i class="fa fa-check"></i><b>7.7</b> Example: Monte-Carlo Integration</a></li>
<li class="chapter" data-level="7.8" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#example-buffons-needle"><i class="fa fa-check"></i><b>7.8</b> Example: Buffon’s needle</a><ul>
<li class="chapter" data-level="7.8.1" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-1-backend"><i class="fa fa-check"></i><b>7.8.1</b> Step 1: Backend</a></li>
<li class="chapter" data-level="7.8.2" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-2-frontend"><i class="fa fa-check"></i><b>7.8.2</b> Step 2: Frontend</a></li>
<li class="chapter" data-level="7.8.3" data-path="shiny-web-applications.html"><a href="shiny-web-applications.html#step-3-connecting-frontend-and-backend"><i class="fa fa-check"></i><b>7.8.3</b> Step 3: Connecting frontend and backend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>8</b> R Packages</a><ul>
<li class="chapter" data-level="8.1" data-path="r-packages.html"><a href="r-packages.html#basic-steps"><i class="fa fa-check"></i><b>8.1</b> Basic steps</a><ul>
<li class="chapter" data-level="8.1.1" data-path="r-packages.html"><a href="r-packages.html#step-1-create-an-empty-r-package"><i class="fa fa-check"></i><b>8.1.1</b> Step 1: Create an “empty” R package</a></li>
<li class="chapter" data-level="8.1.2" data-path="r-packages.html"><a href="r-packages.html#step-2-edit-description-file"><i class="fa fa-check"></i><b>8.1.2</b> Step 2: Edit description file</a></li>
<li class="chapter" data-level="8.1.3" data-path="r-packages.html"><a href="r-packages.html#step-3-move-your-r-scripts-into-the-r-folder"><i class="fa fa-check"></i><b>8.1.3</b> Step 3: Move your R scripts into the R folder</a></li>
<li class="chapter" data-level="8.1.4" data-path="r-packages.html"><a href="r-packages.html#step-4-documentation"><i class="fa fa-check"></i><b>8.1.4</b> Step 4: Documentation</a></li>
<li class="chapter" data-level="8.1.5" data-path="r-packages.html"><a href="r-packages.html#step-5-test-your-package"><i class="fa fa-check"></i><b>8.1.5</b> Step 5: Test your package</a></li>
<li class="chapter" data-level="8.1.6" data-path="r-packages.html"><a href="r-packages.html#step-6-add-a-readme.rmd-file"><i class="fa fa-check"></i><b>8.1.6</b> Step 6: Add a “README.Rmd” file</a></li>
<li class="chapter" data-level="8.1.7" data-path="r-packages.html"><a href="r-packages.html#step-7-create-a-github-repo---possibly-with-the-same-name-as-package"><i class="fa fa-check"></i><b>8.1.7</b> Step 7: Create a github repo - possibly with the same name as package</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="r-packages.html"><a href="r-packages.html#advanced"><i class="fa fa-check"></i><b>8.2</b> Advanced</a><ul>
<li class="chapter" data-level="8.2.1" data-path="r-packages.html"><a href="r-packages.html#adding-a-shiny-app"><i class="fa fa-check"></i><b>8.2.1</b> Adding a shiny app</a></li>
<li class="chapter" data-level="8.2.2" data-path="r-packages.html"><a href="r-packages.html#custom-website"><i class="fa fa-check"></i><b>8.2.2</b> Custom website</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>9</b> High performance computing</a><ul>
<li class="chapter" data-level="9.1" data-path="high-performance-computing.html"><a href="high-performance-computing.html#rcpp-using-c-within-r"><i class="fa fa-check"></i><b>9.1</b> Rcpp: using C++ within R</a><ul>
<li class="chapter" data-level="9.1.1" data-path="high-performance-computing.html"><a href="high-performance-computing.html#installation"><i class="fa fa-check"></i><b>9.1.1</b> Installation</a></li>
<li class="chapter" data-level="9.1.2" data-path="high-performance-computing.html"><a href="high-performance-computing.html#a-first-program"><i class="fa fa-check"></i><b>9.1.2</b> A first program</a></li>
<li class="chapter" data-level="9.1.3" data-path="high-performance-computing.html"><a href="high-performance-computing.html#data-structures"><i class="fa fa-check"></i><b>9.1.3</b> Data structures</a></li>
<li class="chapter" data-level="9.1.4" data-path="high-performance-computing.html"><a href="high-performance-computing.html#control-structures"><i class="fa fa-check"></i><b>9.1.4</b> Control structures</a></li>
<li class="chapter" data-level="9.1.5" data-path="high-performance-computing.html"><a href="high-performance-computing.html#functions-1"><i class="fa fa-check"></i><b>9.1.5</b> Functions</a></li>
<li class="chapter" data-level="9.1.6" data-path="high-performance-computing.html"><a href="high-performance-computing.html#comparing-with-r"><i class="fa fa-check"></i><b>9.1.6</b> Comparing with R</a></li>
<li class="chapter" data-level="9.1.7" data-path="high-performance-computing.html"><a href="high-performance-computing.html#example-buffons-needle-cont"><i class="fa fa-check"></i><b>9.1.7</b> Example: Buffon’s needle (con’t)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="website-creation.html"><a href="website-creation.html"><i class="fa fa-check"></i><b>10</b> Website creation</a></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="basic-probability-and-statistics-with-r-1.html"><a href="basic-probability-and-statistics-with-r-1.html"><i class="fa fa-check"></i><b>A</b> Basic Probability and Statistics with <code>R</code></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Programming Methods with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="high-performance-computing" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> High performance computing</h1>
<div id="rcpp-using-c-within-r" class="section level2">
<h2><span class="header-section-number">9.1</span> Rcpp: using C++ within R</h2>
<p>Whereas R is a relatively new language targetting essentially statistician and data analyst, C++ is a well-established general-purpose programming language. This chapter does not aim at covering programmation in C++ per se, but rather to address specific problems related to R. The point of view taken here is that of the R programmer having no notions of C++ or similar language. We do not describe accurately notions of C++ but rather give some necessary concepts for starting programming.</p>
<p>R is an <a href="https://en.wikipedia.org/wiki/Interpreted_language">interpreted language</a> which makes it particularly slow for repeating operations such as for and while loops, or recursive calling of functions. On the other hand, C++ is a <a href="https://en.wikipedia.org/wiki/Compiled_language">compiled language</a>, it means that before being able to use your code, it is translated (compiled) to lower-level machine language which makes the code running very fast.</p>
<p>Note that here we jump straight to the C++ solution, but there are many ways to enhance your R code such as <a href="http://www.dartistics.com/fast-r-code.html">vectorization</a> and <a href="http://adv-r.had.co.nz/memory.html">memory management</a>. <a href="http://adv-r.had.co.nz/Profiling.html">Profiling</a> also helps to identify which parts of the code is the slowest.</p>
<p>Note eventually that C++ compiles <em>ahead of time</em> (before using the code), but other approaches exist such as the <a href="https://julialang.org/">Julia language</a> that compiles <em>just in time</em> (at runtime).</p>
<div id="installation" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Installation</h3>
<p>Working with C++ in R does not come “out of the box”, but do not worry, it is now a well handled procedure. You need essentially two elements: a C++ compiler and a program that permits to connect R and C++. For the latter, you need to install the <code>Rcpp</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For CRAN official release</span>
<span class="kw">install.packages</span>(<span class="st">&quot;Rcpp&quot;</span>)

<span class="co"># For development version</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;RcppCore/Rcpp&quot;</span>)</code></pre></div>
<p>For the former, it depends on your OS:<br />
1. On Windows, install <code>RTools</code>.<br />
2. On Mac, install <code>Xcode</code> from the App Store.<br />
3. On Linux, you need to install <code>r-bas-dev</code> (or similar) from your package manager.</p>
<p>Verify that your installation works by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(Rcpp)
<span class="kw">cppFunction</span>(<span class="st">&quot;double sumC(double x, double y){</span>
<span class="st">  double s;</span>
<span class="st">  s = x + y;</span>
<span class="st">  return s;</span>
<span class="st">} &quot;</span>)
<span class="kw">sumC</span>(<span class="fl">3.5</span>, <span class="fl">6.5</span>)</code></pre></div>

<div class="rmdcaution">
In C++, a line of code must end with a semicolumn <code>;</code>. Otherwise, compiler returns an error.
</div>

<p>The function <code>sumC(x,y)</code> takes two doubles (numeric) values, <code>x</code> and <code>y</code>, and it returns a double, the sum of the two values. Can you predict what happens if you run the following lines? Can you explain why?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sumC</span>(3L, 6L)
<span class="kw">sumC</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
<span class="kw">sumC</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>))</code></pre></div>
</div>
<div id="a-first-program" class="section level3">
<h3><span class="header-section-number">9.1.2</span> A first program</h3>
<p>The above <code>cppFunction()</code> creates an <em>inline</em> C++ function (within your R code). However, it is better practice to create a separate file dedicated to C++ functions. It is possible then to compile your C++ functions and call them within R.</p>
<p>In RStudio, you can create a C++ file by clicking on <em>File</em> &gt; <em>New File</em> &gt; <em>C++ File</em>. RStudio provides you with an example. At the top of C++ file, you should see:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</code></pre></div>
<p>The first line tells your program that you can access functionalities from the <code>Rcpp</code> library. The second line tells your program that you can access those functionalities without specifying the <code>Rcpp</code> library. For example, suppose there is function <code>mean()</code> in <code>Rcpp</code>. With the first line, you could use this function only by typing <code>Rcpp::mean()</code>. Adding the second line allow you to write directly <code>mean()</code> in your program. This is somehow equivalent as using <code>library(Rcpp)</code> in your R code.</p>
<p>Once the C++ code is written, it should be saved with the appropriate extension, use <code>*.cc</code> or <code>*.cpp</code>. Now you can compile your first C++ program. Type in your R file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sourceCpp</span>(<span class="st">&quot;file_name.cpp&quot;</span>)</code></pre></div>
<p>Try to write the <code>sumC()</code> function within a separate C++ file and compile it in R.</p>
<p>By default, C++ functions are not accessible within your R program. One key element is to use the attribute <code>[[Rcpp::export]]</code> in comment <strong>just before the function definition</strong>. For example:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> Rcpp;

<span class="co">// [[Rcpp::export]]</span>
<span class="dt">double</span> sumC(
    <span class="dt">double</span> x,
    <span class="dt">double</span> y
) {
  <span class="dt">double</span> s;
  s = x + y;
  <span class="cf">return</span> s;
}</code></pre></div>

<div class="rmdnote">
In C++, the symbol <code>//</code> is used for single line comment. The symbol <code>/*</code> starts a comment on possibly multiple lines and <code>*/</code> ends the comment.
</div>

</div>
<div id="data-structures" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Data structures</h3>
<p>One difference you can immediately notice while working with C++ is that you need to tell the program what type of data structure you intend to use, before using it. This makes the code safer, the programmer needs to think more deeply on the implementation details and it prevents from using the code in a way it was not intended. On the other hand, the programmer will spend (at least at the beginning) more time conceiving the code.</p>
<p>Here is a list of primitive data types with their keywords:<br />
- <code>int</code> (4) : integer,<br />
- <code>float</code> (4) : single precision floating number (numeric),<br />
- <code>double</code> (8) : double precision floating number (numeric),<br />
- <code>bool</code> : logical (true or false),<br />
- <code>char</code> : character,<br />
- <code>void</code> : without any value.</p>
<p>The numbers in parenthesis represents typical memory in bytes required to store the variable. Single and double precision floating number represents how the computer stores real numbers in the memory. <code>float</code> requires less memory than <code>double</code> but is less precise. As a general rule, we use only <code>double</code> as it is already the case in R:</p>
<blockquote>
<p>R has no single precision data type. All real numbers are stored in double precision format.</p>
<p><code>help(double)</code> in R</p>
</blockquote>
<p>These data types can be modified by using one (or more) of the following keywords:<br />
- <code>long</code> : allocate more space in memory,<br />
- <code>short</code> : allocate less space in memory,<br />
- <code>unsigned</code> : numbers take only positive value.</p>
<p>For more complex data structures such as vectors and matrices, the story is slightly more complicated. Hopefully for R programmers, <code>Rcpp</code> provides a lot of predefined structures which makes the transition to C++ easier. Here is a non-exhaustive list:</p>
<p>Table : Common data structure in R with Rcpp equivalent.</p>
<table>
<thead>
<tr class="header">
<th>Rcpp</th>
<th>R</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>NumericVector</code></td>
<td><code>c(...)</code> or <code>vector(mode = &quot;double&quot;, ...)</code></td>
<td>A vector of double</td>
</tr>
<tr class="even">
<td><code>IntegerVector</code></td>
<td><code>c(...)</code> or <code>vector(mode = &quot;integer&quot;, ...)</code></td>
<td>A vector of integer</td>
</tr>
<tr class="odd">
<td><code>LogicalVector</code></td>
<td><code>c(...)</code> or <code>vector(mode = &quot;bool&quot;, ...)</code></td>
<td>A vector of boolean</td>
</tr>
<tr class="even">
<td><code>NumericMatrix</code></td>
<td><code>matrix()</code></td>
<td>A matrix of double</td>
</tr>
<tr class="odd">
<td><code>IntegerMatrix</code></td>
<td><code>matrix()</code></td>
<td>A matrix of integer</td>
</tr>
<tr class="even">
<td><code>LogicalMatrix</code></td>
<td><code>matrix()</code></td>
<td>A matrix of boolean</td>
</tr>
<tr class="odd">
<td><code>List</code></td>
<td><code>list</code></td>
<td>A list</td>
</tr>
<tr class="even">
<td><code>DataFrame</code></td>
<td><code>data.frame()</code></td>
<td>A data frame</td>
</tr>
</tbody>
</table>
<div id="vectors-1" class="section level4">
<h4><span class="header-section-number">9.1.3.1</span> Vectors</h4>
<p>Before using a vector in C++, you need to create one. For example,</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">NumericVector v(<span class="dv">10</span>);</code></pre></div>
<p>creates an empty vector of double of length 10.</p>
<p>To access elements of a vector, the syntax is the same as in R with one notable exception: <strong>accessor starts at 0</strong>! So if you want to access the first element of a vector <code>v</code>, you should write <code>v[0]</code>, the ith element, <code>v[i-1]</code>. Note that you can equivalently write <code>v(0)</code> and <code>v(i-1)</code>.</p>
<p>Eventually, the length of the vector <code>v</code> can be obtained as follows</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="dt">int</span> n = v.length();</code></pre></div>
<p>Here the length of the vector is saved into an integer <code>n</code>.</p>
<p>Note that <code>length()</code> is a <em>method</em> for the <em>class</em> <code>NumericVector</code> and uses the syntax ‘’dot-function’’. Theses concepts are beyond the scope of this introduction, the only to remark is that the above notation gives the same result as if you wrote <code>length(v)</code> in R.</p>
</div>
<div id="matrices-1" class="section level4">
<h4><span class="header-section-number">9.1.3.2</span> Matrices</h4>
<p>Creating a matrix is similar to vector.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">NumericMatrix m(<span class="dv">3</span>,<span class="dv">4</span>);</code></pre></div>
<p>creates an empty matrix with 3 rows and 4 columns. This is equivalent as writing in R</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nr=</span><span class="dv">3</span>,<span class="dt">nc=</span><span class="dv">4</span>)</code></pre></div>
<p>The syntax for accessing matrix elements is slightly different. For example, accessing a column or a row can be done as follows</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// Copy first column into a vector</span>
NumericVector v = m( _ , <span class="dv">0</span>);

<span class="co">// Copy first row into a vector</span>
NumericVector v = m(<span class="dv">0</span>, _);

<span class="co">// Access the ith row, jth column</span>
<span class="dt">double</span> x = m(i<span class="dv">-1</span>, j<span class="dv">-1</span>); <span class="co">// i and j are positive integers already defined</span></code></pre></div>
<p>The number of column/row of a matrix can be retrieved using</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// number of rows</span>
<span class="dt">int</span> nr = m.nrow();

<span class="co">// number of columns</span>
<span class="dt">int</span> nc = m.ncol();</code></pre></div>
</div>
<div id="list-1" class="section level4">
<h4><span class="header-section-number">9.1.3.3</span> List</h4>
<p>List creation can be accomplished as follows:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// Create a list from elements e1 and e2</span>
List L = List::create(e1, e2);

<span class="co">// Create a list from elements e1 and e2 with names</span>
List L = List::create(Named(<span class="st">&quot;name1&quot;</span>) e1, Named(<span class="st">&quot;name2&quot;</span>) e2);</code></pre></div>
</div>
</div>
<div id="control-structures" class="section level3">
<h3><span class="header-section-number">9.1.4</span> Control structures</h3>
<p>Logical operators in R and C++ are similar. Here is a list where <code>x</code> and <code>y</code> are scalar (not vectors!).</p>
<table>
<caption>Common logical operators for C++.</caption>
<thead>
<tr class="header">
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x &gt; y</code></td>
<td><code>x</code> greater than <code>y</code></td>
</tr>
<tr class="even">
<td><code>x &gt;= y</code></td>
<td><code>x</code> greater than or equals to <code>y</code></td>
</tr>
<tr class="odd">
<td><code>x &lt; y</code></td>
<td><code>x</code> less than <code>y</code></td>
</tr>
<tr class="even">
<td><code>x &lt;= y</code></td>
<td><code>x</code> less than or equals to <code>y</code></td>
</tr>
<tr class="odd">
<td><code>x == y</code></td>
<td><code>x</code> equals to <code>y</code></td>
</tr>
<tr class="even">
<td><code>x != y</code></td>
<td><code>x</code> not equal to <code>y</code></td>
</tr>
<tr class="odd">
<td><code>x &amp;&amp; y</code></td>
<td><code>x</code> and <code>y</code></td>
</tr>
<tr class="even">
<td><code>x || y</code></td>
<td><code>x</code> or <code>y</code></td>
</tr>
<tr class="odd">
<td><code>!x</code></td>
<td>not <code>x</code></td>
</tr>
</tbody>
</table>
<div id="ifelseelseif-statements" class="section level4">
<h4><span class="header-section-number">9.1.4.1</span> if/else/elseif statements</h4>
<p>R and C++ share the same syntax for <code>if</code>/<code>else</code>/<code>elseif</code> statements at the exception that <code>else if</code> has a space. For example, the following expression is both valid within R and C++:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (condition){
  plan A;
}<span class="cf">else</span>{
  plan B;
}</code></pre></div>
</div>
<div id="loops" class="section level4">
<h4><span class="header-section-number">9.1.4.2</span> loops</h4>
<p>For loops are much faster in C++ than R. The syntax is slightly different. For example, the following R for loop</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="st">&quot;The value is: &quot;</span>, i)
}</code></pre></div>
<p>can be written in C++ with the following code</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="cf">for</span>(<span class="dt">int</span> i(<span class="dv">1</span>); i&lt;=<span class="dv">10</span>; i++){
  Rcpp::Rcout &lt;&lt; <span class="st">&quot;The value is: &quot;</span> &lt;&lt; i &lt;&lt; <span class="bu">std::</span>endl;
}</code></pre></div>
<p>Three elements need to be defined:<br />
1. The initialization statement: an iterator (<code>i</code> here), generally of type integer, needs to be initialized (here <code>i</code> is initialized to 1).<br />
2. The test expression: the expression is evaluated and should return a boolean. If <code>false</code> the loop stops and if <code>true</code>, the body of the for loop is evaluated.<br />
3. The update statement: it defines the increment of the iterator, usually set to <code>i++</code>.</p>
<p>Note that there exists also the decrement operator <code>i--</code>.</p>
<p>C++ also offers variants of assignment operator.</p>
<table style="width:100%;">
<caption>Assignment operator in C++. <code>x</code> and <code>y</code> are already defined.</caption>
<colgroup>
<col width="14%" />
<col width="14%" />
<col width="71%" />
</colgroup>
<thead>
<tr class="header">
<th>Operator</th>
<th>Equivalence</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x = y;</code></td>
<td></td>
<td>Assign the value of <code>y</code> into <code>x</code></td>
</tr>
<tr class="even">
<td><code>x += y;</code></td>
<td><code>x = x + y;</code></td>
<td>Take the value of <code>x</code> and adds <code>y</code>, then assign to <code>x</code></td>
</tr>
<tr class="odd">
<td><code>x -= y;</code></td>
<td><code>x = x - y;</code></td>
<td>Take the value of <code>x</code> and substracts <code>y</code>, then assign to <code>x</code></td>
</tr>
<tr class="even">
<td><code>x *= y;</code></td>
<td><code>x = x * y;</code></td>
<td>Take the value of <code>x</code> and multiplies by <code>y</code>, then assign to <code>x</code></td>
</tr>
<tr class="odd">
<td><code>x /= y;</code></td>
<td><code>x = x / y;</code></td>
<td>Take the value of <code>x</code> and divides by <code>y</code>, then assign to <code>x</code></td>
</tr>
</tbody>
</table>
<p>Therefore, <code>i++</code> is equivalent to <code>i+=1</code>.</p>
<p>Write a loop that takes an increment of 2, 3, …</p>
<p>C++ while loop has the same syntax as R. The following expression</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="cf">while</span>( condition ) {
  body;
}</code></pre></div>
<p>is licit in both languages.</p>
<p>Note that C++ is also equiped with a <code>do ... while</code> loop. This maybe useful for example in the situation where you need a first run of the body prior to checking the condition.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="cf">do</span>{
  body;
}
<span class="cf">while</span>(condition);</code></pre></div>
</div>
</div>
<div id="functions-1" class="section level3">
<h3><span class="header-section-number">9.1.5</span> Functions</h3>
<p>Creating functions in C++ is fundamentally not much different than R. Neverthelss, C++ requires an additional layer of precision. A function can follow this pattern:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">type function_name(type arg1, ..., type argn){
  body of the function;
  
  <span class="cf">return</span> obj;
}</code></pre></div>
<p>First, the type of return of the function should be specified. The <code>obj</code> that is returned should be of the same type as the one specified at the function declaration. Each argument should have a type. Otherwise, as in R, the body of the function contains statements that defines what the function does.</p>
<p>As already said, by default C++ function cannot be used with R. One key element is to use the attribute <code>[[Rcpp::export]]</code> in comment <strong>just before the function definition</strong>. For example</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// [[Rcpp::export]]</span>
type function_name(type arg1, ..., type argn){
  body of the function;
  
  <span class="cf">return</span> obj;
}</code></pre></div>
<p>will make <code>function_name</code> available within R.</p>
</div>
<div id="comparing-with-r" class="section level3">
<h3><span class="header-section-number">9.1.6</span> Comparing with R</h3>
<p>Puting efforts in writing C++ code instead of R should be rewarding. One way to measure this reward is by comparing the computational efficiency of C++ function in comparison to the equivalent R function. This can be achieved for example using the <code>microbenchmark</code> package.</p>
<p>For example, suppose you create a function that computes the factorial number of an input positive integer. In R, you can write</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_factorialR &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  factorial &lt;-<span class="st"> </span><span class="dv">1</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){
    factorial &lt;-<span class="st"> </span>factorial <span class="op">*</span><span class="st"> </span>i
  }
  <span class="kw">return</span>(factorial)
}</code></pre></div>
<p>An equivalent C++ function could be</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="dt">int</span> my_factorialC(<span class="dt">int</span> n){
  <span class="dt">int</span> factorial = <span class="dv">1</span>;
  <span class="cf">for</span>(<span class="dt">int</span> i(<span class="dv">2</span>); i&lt;=n; ++i){
    factorial *= i;
  }
  <span class="cf">return</span> factorial;
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(microbenchmark)
<span class="kw">microbenchmark</span>(<span class="kw">my_factorial</span>(<span class="dv">500</span>), <span class="kw">my_factorialC</span>(<span class="dv">500</span>))</code></pre></div>
<pre><code>## Unit: microseconds
##                expr    min      lq     mean  median     uq    max neval
##   my_factorial(500) 43.644 43.7395 44.18116 43.9105 44.015 48.123   100
##  my_factorialC(500)  2.521  2.5705  3.56807  2.6340  2.684 85.821   100
##  cld
##    b
##   a</code></pre>
</div>
<div id="example-buffons-needle-cont" class="section level3">
<h3><span class="header-section-number">9.1.7</span> Example: Buffon’s needle (con’t)</h3>
<p>Let’s reconsider Buffon’s needle problem. We propose to recode the R functions <code>cast_needle()</code> and <code>buffon_experiment()</code> into C++.</p>
<p>For this purpose, first create a C++ file with header</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span>
<span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</code></pre></div>
<p>The <code>cast_needle()</code> function was defined as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cast_needle &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">plane_width =</span> <span class="dv">20</span>){
  available_range &lt;-<span class="st"> </span>plane_width<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co"># where 1 is the length of the needle (unit)</span>
  x_start &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">2</span>, <span class="op">-</span>available_range, available_range)
  angle &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>pi)
  x_end &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(angle), <span class="kw">sin</span>(angle)) <span class="op">+</span><span class="st"> </span>x_start <span class="co"># where the angles are multiplied by the needle length which is 1 in this example</span>
  cross &lt;-<span class="st"> </span><span class="kw">floor</span>(x_start[<span class="dv">2</span>]) <span class="op">!=</span><span class="st"> </span><span class="kw">floor</span>(x_end[<span class="dv">2</span>])
  out &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">start =</span> x_start, <span class="dt">end =</span> x_end, <span class="dt">cross =</span> cross)
  out
}</code></pre></div>
<p>A possible C++ implementation is</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// [[Rcpp::export]]</span>
List cast_needle(
  <span class="dt">unsigned</span> <span class="dt">int</span> plane_width = <span class="dv">20</span>
){
  <span class="co">// Variable declaration</span>
  <span class="dt">int</span> available_range;
  <span class="dt">double</span> angle,my_pi;
  NumericVector x_start(<span class="dv">2</span>), x_end(<span class="dv">2</span>), tmp_angle(<span class="dv">1</span>);
  <span class="dt">bool</span> cross;
  
  <span class="co">// Computation</span>
  my_pi = atan(<span class="dv">1</span>) * <span class="dv">4</span>; <span class="co">// defines pi (for simplicity)</span>
  available_range = plane_width / <span class="dv">2</span> - <span class="dv">1</span>;
  x_start = runif(<span class="dv">2</span>, -available_range, available_range);
  tmp_angle = runif(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span> * my_pi);
  angle = tmp_angle[<span class="dv">0</span>];
  x_end[<span class="dv">0</span>] = cos(angle) + x_start[<span class="dv">0</span>];
  x_end[<span class="dv">1</span>] = sin(angle) + x_start[<span class="dv">1</span>];
  cross = floor(x_start[<span class="dv">2</span>]) != floor(x_end[<span class="dv">2</span>]);
  
  <span class="cf">return</span> List::create(
    Named(<span class="st">&quot;start&quot;</span>) = x_start,
    Named(<span class="st">&quot;end&quot;</span>) = x_end,
    Named(<span class="st">&quot;cross&quot;</span>) = cross
  );
}</code></pre></div>
<p>We have few remarks:</p>
<ul>
<li>For better readibility, it is better practice to separate variable declaration and computation.<br />
</li>
<li>The value of <span class="math inline">\(\pi\)</span> is not accessible by default, here we simply approximate it but better solutions exist.<br />
</li>
<li>Basic functions such as <code>atan()</code>, <code>runif()</code>, <code>floor()</code>, <code>cos()</code>, <code>sin()</code> are made available by <code>Rcpp</code> (check for <strong>Rcpp sugar</strong>).<br />
</li>
<li>To avoid an error we have first to save the result of <code>runif()</code> as <code>NumericVector</code>, its default result’s type.</li>
</ul>
<p>The <code>buffon_needle()</code> function was declared in R as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">buffon_experiment &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">B =</span> <span class="dv">2084</span>, <span class="dt">plane_width =</span> <span class="dv">10</span>, <span class="dt">seed =</span> <span class="ot">NULL</span>){
  
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(seed)){
    <span class="kw">set.seed</span>(seed)
  }
  
  X_start &lt;-<span class="st"> </span>X_end &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, B, <span class="dv">2</span>) 
  cross &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)
  
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){
    inter &lt;-<span class="st"> </span><span class="kw">cast_needle</span>(<span class="dt">plane_width =</span> plane_width)
    X_start[i, ] &lt;-<span class="st"> </span>inter<span class="op">$</span>start
    X_end[i, ] &lt;-<span class="st"> </span>inter<span class="op">$</span>end
    cross[i] &lt;-<span class="st"> </span>inter<span class="op">$</span>cross
  }
  
  out &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">start =</span> X_start, <span class="dt">end =</span> X_end, <span class="dt">cross =</span> cross, <span class="dt">plane =</span> plane_width)
  <span class="kw">class</span>(out) &lt;-<span class="st"> &quot;buffon_experiment&quot;</span>
  out
}</code></pre></div>
<p>The C++ alternative we propose is the following</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// [[Rcpp::export]]</span>
List buffon_experiment(
  <span class="dt">int</span> B = <span class="dv">2084</span>,
  <span class="dt">int</span> plane_width = <span class="dv">10</span>
){
  <span class="co">// Variable declaration</span>
  NumericMatrix X_start(B,<span class="dv">2</span>), X_end(B,<span class="dv">2</span>);
  LogicalVector cross(B);
  List L;
  NumericVector tmp(<span class="dv">2</span>);
  
  <span class="co">// Computation</span>
  <span class="cf">for</span>(<span class="dt">int</span> i(<span class="dv">0</span>); i&lt;B; ++i){
    L = cast_needle(plane_width);
    tmp = L[<span class="st">&quot;start&quot;</span>];
    X_start(i,_) = tmp; 
    tmp = L[<span class="st">&quot;end&quot;</span>];
    X_end(i,_) = tmp;
    cross(i) = L[<span class="st">&quot;cross&quot;</span>];
  }
  
  <span class="cf">return</span> List::create(
    Named(<span class="st">&quot;start&quot;</span>) = X_start,
    Named(<span class="st">&quot;end&quot;</span>) = X_end,
    Named(<span class="st">&quot;cross&quot;</span>) = cross,
    Named(<span class="st">&quot;plane&quot;</span>) = plane_width
  );
}</code></pre></div>
<p>We have few remarks:</p>
<ul>
<li>C++ does not know the content of <code>L[&quot;start&quot;]</code> in advanced, so it is saved first into a vector <code>tmp</code> of the right dimension. Same for <code>L[&quot;end&quot;]</code>.<br />
</li>
<li>To avoid complexity, the list returned by the C++ implementation has not the class <em>buffon_experiment</em>. This should be added within R.</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-packages.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="website-creation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-rcpp.Rmd",
"text": "Edit"
},
"download": ["ds.pdf", "ds.dvi", "ds.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
