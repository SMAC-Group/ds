<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical Programming Methods with R</title>
  <meta name="description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control.">
  <meta name="generator" content="bookdown 0.4.1 and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical Programming Methods with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control." />
  <meta name="github-repo" content="smac-group/ds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical Programming Methods with R" />
  
  <meta name="twitter:description" content="This book is under construction and serves as a reference for students or other interested readers who intend to learn the basics of statistical programming using the R language. The book will provide the reader with notions of data management, manipulation and analysis as well as of reproducible research, result-sharing and version control." />
  

<meta name="author" content="Matthew Beckman, Stéphane Guerrier, Justin Lee &amp; Roberto Molinari">


<meta name="date" content="2017-11-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="functions.html">
<link rel="next" href="placeholder.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Programming Methods</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>I Foundation</b></span></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> RMarkdown</a></li>
<li class="chapter" data-level="3" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3</b> GitHub</a></li>
<li class="part"><span><b>II Introduction to R</b></span></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a></li>
<li class="chapter" data-level="5" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>5</b> Control Structures</a></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a></li>
<li class="chapter" data-level="7" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>7</b> Shiny</a><ul>
<li class="chapter" data-level="7.1" data-path="shiny.html"><a href="shiny.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="shiny.html"><a href="shiny.html#step-1.-r-code-server-backend"><i class="fa fa-check"></i><b>7.2</b> Step 1. R Code / Server / Backend</a></li>
<li class="chapter" data-level="7.3" data-path="shiny.html"><a href="shiny.html#step-2-user-interface-ui-frontend"><i class="fa fa-check"></i><b>7.3</b> Step 2: User Interface (UI) / Frontend</a><ul>
<li class="chapter" data-level="" data-path="shiny.html"><a href="shiny.html#content-creation"><i class="fa fa-check"></i>Content Creation</a></li>
<li class="chapter" data-level="" data-path="shiny.html"><a href="shiny.html#input-controls"><i class="fa fa-check"></i>Input Controls</a></li>
<li class="chapter" data-level="" data-path="shiny.html"><a href="shiny.html#output-render-controls"><i class="fa fa-check"></i>Output Render Controls</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="shiny.html"><a href="shiny.html#step-3-connecting-frontend-and-backend"><i class="fa fa-check"></i><b>7.4</b> Step 3: Connecting frontend and backend</a></li>
<li class="chapter" data-level="7.5" data-path="shiny.html"><a href="shiny.html#step-4-customize"><i class="fa fa-check"></i><b>7.5</b> Step 4: Customize</a></li>
<li class="chapter" data-level="7.6" data-path="shiny.html"><a href="shiny.html#example-monte-carlo-integration"><i class="fa fa-check"></i><b>7.6</b> Example: Monte-Carlo Integration</a></li>
<li class="chapter" data-level="7.7" data-path="shiny.html"><a href="shiny.html#example-buffons-needle"><i class="fa fa-check"></i><b>7.7</b> Example: Buffon’s needle</a><ul>
<li class="chapter" data-level="7.7.1" data-path="shiny.html"><a href="shiny.html#step-1-backend"><i class="fa fa-check"></i><b>7.7.1</b> Step 1: Backend</a></li>
<li class="chapter" data-level="7.7.2" data-path="shiny.html"><a href="shiny.html#step-2-frontend"><i class="fa fa-check"></i><b>7.7.2</b> Step 2: Frontend</a></li>
<li class="chapter" data-level="7.7.3" data-path="shiny.html"><a href="shiny.html#step-3-connecting-frontend-and-backend-1"><i class="fa fa-check"></i><b>7.7.3</b> Step 3: Connecting frontend and backend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="placeholder.html"><a href="placeholder.html"><i class="fa fa-check"></i><b>8</b> Placeholder</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Programming Methods with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shiny" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Shiny</h1>
<p>Shiny is an R package that makes it easy to build interactive web apps straight from R.</p>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>Before building the application, we want to know to build our application, and think more like a software engineer. We want to take some input, such as parameters, and produce output. In this chapter we will build the shiny applicaion building procedure.</p>
</div>
<div id="step-1.-r-code-server-backend" class="section level2">
<h2><span class="header-section-number">7.2</span> Step 1. R Code / Server / Backend</h2>
<p>Before we start thinking of the web application, we want to focus on the R Code, or also commonly known as the “backend” of the application. For all the intended operations to work in the application we need to make sure that the R code that serves as the skeleton operates in the way the developer want it to be.</p>
<p>For example, perhaps we are trying to build an application that builds a histogram from the waiting time of the default R dataset, Old Faithful Geyser Dataset. We also want to add an option for controlling the number of bins.</p>
<p>For this to work, we want to build the histogram in R and test out to see if the output is what was desired initially. Below we create the default histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>faithful[, <span class="dv">2</span>] 
<span class="kw">hist</span>(x)</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Now we want to make sure to later add the option of creating more bins so the graph is customizable. In the <code>hist()</code> function, we see an option <code>breaks</code> that we can use to take in different inputs based on what the client wants.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))

<span class="co"># Compare the differences! </span>
bins &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="dt">length.out =</span> <span class="dv">10</span>)
<span class="kw">hist</span>(x, <span class="dt">breaks =</span> bins)

bins &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="dt">length.out =</span> <span class="dv">20</span>)
<span class="kw">hist</span>(x, <span class="dt">breaks =</span> bins)</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="step-2-user-interface-ui-frontend" class="section level2">
<h2><span class="header-section-number">7.3</span> Step 2: User Interface (UI) / Frontend</h2>
<p>The previous information goes into a part called the “server” in the shiny application. Now we want to focus on the frontend of the application, the things we “see” and options we can interact with when we open the app.</p>
<div id="content-creation" class="section level3 unnumbered">
<h3>Content Creation</h3>
<p>We want to design the application in the way that it is comprehensive and also easy to interpret. Below are some often-used options of content creation that will be beneficial to know.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>titlePanel()</td>
<td>The title of the application</td>
</tr>
<tr class="even">
<td>sidebarLayout()</td>
<td>Creates a sidebar layout for fluidPage()</td>
</tr>
<tr class="odd">
<td>sidebarPanel()</td>
<td>Makes a sidebar menu</td>
</tr>
<tr class="even">
<td>mainPanel()</td>
<td>Main content area for different outputs</td>
</tr>
</tbody>
</table>
</div>
<div id="input-controls" class="section level3 unnumbered">
<h3>Input Controls</h3>
<p>We also want to provide spaces so that the client can change any desired parameter. For example, in the above example, this would be the number of bins. Below are some input controls the developer can use.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>numericInput()</td>
<td>Number entry input</td>
</tr>
<tr class="even">
<td>radioButtons()</td>
<td>Radio button selection</td>
</tr>
<tr class="odd">
<td>selectInput()</td>
<td>Dropdown menu</td>
</tr>
<tr class="even">
<td>sliderInput()</td>
<td>Range slider (1/2 values)</td>
</tr>
<tr class="odd">
<td>submitButton()</td>
<td>Submission button</td>
</tr>
<tr class="even">
<td>textInput()</td>
<td>Text input box</td>
</tr>
<tr class="odd">
<td>checkboxInput()</td>
<td>Single checkbox input</td>
</tr>
<tr class="even">
<td>dateInput()</td>
<td>Date Selection input</td>
</tr>
<tr class="odd">
<td>fileInput()</td>
<td>Upload a file to Shiny</td>
</tr>
<tr class="even">
<td>helpText()</td>
<td>Describe input field</td>
</tr>
</tbody>
</table>
</div>
<div id="output-render-controls" class="section level3 unnumbered">
<h3>Output Render Controls</h3>
<p>The different type of output that is shown can be designed depending on what the developer intends it to be. Examples of these options are shown below. We advise you to follow the videos and research different options that fit the desired output.</p>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>plotOutput()</td>
<td>Display a rendered plot</td>
</tr>
<tr class="even">
<td>tableOutput()</td>
<td>Display in Table</td>
</tr>
<tr class="odd">
<td>textOutput()</td>
<td>Formatted Text Output</td>
</tr>
<tr class="even">
<td>uiOutput()</td>
<td>Dynamic UI Elements</td>
</tr>
<tr class="odd">
<td>verbatimTextOutput()</td>
<td>“as is”&quot; Text Output“</td>
</tr>
<tr class="even">
<td>imageOutput()</td>
<td>Render an Image</td>
</tr>
<tr class="odd">
<td>htmlOutput()</td>
<td>Render Pure HTML</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-3-connecting-frontend-and-backend" class="section level2">
<h2><span class="header-section-number">7.4</span> Step 3: Connecting frontend and backend</h2>
<p>Once we have the elements of user interface (UI) and server, we build the application so they come together. Look at the video for more details on this process.</p>
</div>
<div id="step-4-customize" class="section level2">
<h2><span class="header-section-number">7.5</span> Step 4: Customize</h2>
<p>We can confidently say that shiny can be heavily customized, like how webpage applications are customized, even without explicitly using complex javascript or HTML elements.</p>
<p>One of such examples are a <code>submitButton(...)</code>, in which we can run responsive output from input data using a button to initiate. More can be read from <a href="https://shiny.rstudio.com/reference/shiny/1.0.4/submitButton.html">here</a>.</p>
<p>Another of such example is controlling the content creation process other than the default.</p>
</div>
<div id="example-monte-carlo-integration" class="section level2">
<h2><span class="header-section-number">7.6</span> Example: Monte-Carlo Integration</h2>
</div>
<div id="example-buffons-needle" class="section level2">
<h2><span class="header-section-number">7.7</span> Example: Buffon’s needle</h2>
<p>In 1777, the French nobleman Georges-Louis Leclerc, Compte de Buffon posed the following problem to the Royal Academy of Sciences in Paris <span class="citation">(Georges-Louis Leclerc <a href="#ref-buffon1777essai">1777</a>)</span>:</p>
<blockquote>
<p>Suppose that you drop a needle of unit length on a plane ruled by the lines <span class="math inline">\(y = m \; (m = 0, \pm 1, \pm 2, ...)\)</span> - what is then the probability that the needle comes to lie in a position where it crosses one of the lines?</p>
</blockquote>
<p>Compte de Buffon also provided the answer and showed that the needle will intersect lines with a predictable probability. In mathematical terms, his solution (still known today as the Buffon principle) can be stated as follows:</p>
<span class="math display" id="eq:probbuffon">\[\begin{equation} 
\mathbb{P}(\text{intersection}) = \frac{2}{\pi}.
\tag{7.1}
\end{equation}\]</span>
<p>If you are curious about the derivation of this result, click on the button below.</p>
<button id="hidebutton2">
Derivation - Equation (7.1)
</button>
<div id="hideclass2">

<div class="rmdtip">
<p>This proof is based on the solution of Example 4.5.8 of <span class="citation">Grimmett and Stirzaker (<a href="#ref-grimmett2001probability">2001</a>)</span>. We start by letting the point <span class="math inline">\((X, Y)\)</span> denote the coordinates of the center of the needle and let <span class="math inline">\(\Theta\)</span> be the angle, modulo <span class="math inline">\(\pi\)</span>, made by the needle and the horizontal axis. Next, we define the distance from the needle’s center to the nearest line beneath it by <span class="math inline">\(Z = Y - \lfloor Y \rfloor\)</span>, where <span class="math inline">\(\lfloor Y \rfloor\)</span> denotes the “floor” of <span class="math inline">\(Y\)</span>, i.e. the greatest integer not greater than <span class="math inline">\(Y\)</span>. Since the needle is randomly casted we have that the joint density of <span class="math inline">\((Z, \Theta)\)</span> is given by:</p>
<p><span class="math display">\[
f_{Z, \Theta} (z, \theta) = f_{Z} (z) f_{\Theta} (\theta) = \frac{1}{\pi},
\]</span></p>
<p>for <span class="math inline">\(0 \leq z \leq 1\)</span> and <span class="math inline">\(0 \leq \theta \leq \pi\)</span>. By drawing a diagram one can see that an interception occurs if and only if <span class="math inline">\((Z, \Theta) \in \mathcal{B}\)</span>, where</p>
<p><span class="math display">\[
\mathcal{B} = \left\{(z, \theta)\,: \;\; z \leq \frac{1}{2} \sin (\theta)  \;\; \text{or} \;\; 1-z \leq \frac{1}{2} \sin(\theta)\right\}.
\]</span></p>
<p>Therefore, we obtain</p>
<p><span class="math display">\[
\mathbb{P}(\text{intersection}) = \iint_\mathcal{B} \; f_{Z, \Theta} (z, \theta)\, dz \, d\theta = \frac{1}{\pi} \int_0^\pi \left(\int_0^{\frac{1}{2}\sin(\theta)} dz + \int_{1 - \frac{1}{2}\sin(\theta)}^{1} dz \right) d\theta = \frac{2}{\pi},
\]</span></p>
which verifies Equation <a href="shiny.html#eq:probbuffon">(7.1)</a> and concludes the proof.
</div>
<p></p>
</div>
<p></p>
<p>Georges-Louis Leclerc motivation behind this problem was to design an experiment to estimate the value of <span class="math inline">\(\pi\)</span>. Indeed, if you fling a needle a large number <span class="math inline">\(B\)</span> times onto a ruled plane and count the number of times <span class="math inline">\(S_B\)</span> that the needle intersects a line we might be able to approximate <span class="math inline">\(\mathbb{P}(\text{intersection})\)</span> and therefore <span class="math inline">\(\pi\)</span>. From Equation <a href="shiny.html#eq:probbuffon">(7.1)</a>, we know that the proportion <span class="math inline">\(S_B/B\)</span> will be “close” to the probability <span class="math inline">\(\mathbb{P}(\text{intersection})\)</span>. In fact the (weak) law of large number garantees that <span class="math inline">\(S_B/B\)</span> converges (in probability) to <span class="math inline">\(2/\pi\)</span>, i.e. for any given <span class="math inline">\(\varepsilon &gt; 0\)</span>,</p>
<p><span class="math display">\[
\lim_{B \rightarrow \infty} \; \mathbb{P}\left( \left| \frac{S_B}{B} - \frac{2}{\pi} \right|  &gt; \varepsilon \right) = 0.
\]</span></p>
<p>Thus, the estimator</p>
<p><span class="math display">\[
\hat{\pi}_B = \frac{2B}{S_B},
\]</span></p>
<p>is a plausible estimator of <span class="math inline">\(\pi\)</span>. The Continous Mapping Theorem <span class="citation">(see e.g. Theorem 1.14 of DasGupta <a href="#ref-dasgupta2008asymptotic">2008</a>)</span> can (among other) be used to show that <span class="math inline">\(\hat{\pi}\)</span> is a <strong>consistent</strong> estimator of <span class="math inline">\(\pi\)</span> (i.e. <span class="math inline">\(\hat{\pi}\)</span> converges in probability to <span class="math inline">\(\pi\)</span>). In 1777, Georges-Louis Leclerc investigated this problem and computed <span class="math inline">\(\hat{\pi}_B\)</span> by flinging a needle 2084 times, which may consitute the first recorded example of a Monte-Carlo method (simulation?) in use.</p>
<p>To illustarte the convergence of our estimator we could fling <span class="math inline">\(B\)</span> times a needle and compute the following estimators:</p>
<p><span class="math display">\[
\hat{\pi}_j = \frac{2j}{S_j}, \;\; j = k,\, ...., \,B
\]</span></p>
<p>where <span class="math inline">\(k \ll B\)</span>. Then, we could create a graph with <span class="math inline">\(j\)</span> on horizontal axis and <span class="math inline">\(\hat{\pi}_j\)</span> on the horizontal axis. Since <span class="math inline">\(\hat{\pi}_B\)</span> is a consistent estimator we should see that <span class="math inline">\(\hat{\pi}_j\)</span> tends to get closer and closer to <span class="math inline">\(\pi\)</span> as <span class="math inline">\(j\)</span> increase. In this graph we could also superimpose several experiments (recasting the needle <span class="math inline">\(B\)</span> times several times) to reinforce our argument.</p>
<p>The goal of this example is to create a shiny app to visualize and illustarte Buffon’s needle experiment. For this purpose, we will use the following steps:</p>
<ol style="list-style-type: decimal">
<li><strong>Step 1: Backend</strong>: Create all the functions needed for the backend of our app. A possible approach is to create the following functions:
<ol style="list-style-type: lower-alpha">
<li><code>cast_needle()</code> this function randomly casts a needle on plane and returns its coordoniates as well as a binary variable to indicate if the needle crossed a line.</li>
<li><code>buffon_experiment()</code> this function performs a Monte-Carlo experiment by flinging a large number of needles using the function <code>cast_needle()</code>.</li>
<li><code>plot.buffon_experiment()</code> to visualize the experiment (i.e. show all the needles randomly dropped) and compute the estimator <span class="math inline">\(\hat{\pi}_B\)</span> for the experiment at hand.</li>
</ol></li>
</ol>
<ol start="4" style="list-style-type: lower-alpha">
<li><code>converge()</code> to illustarte the convergence of the estimator by the construction the graph mentioned at the end of the previous paragraph.</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li><strong>Step 2: Frontend</strong>: Create widgets to collect all inputs needed by the backend:
<ol style="list-style-type: lower-alpha">
<li>dimension of the plane of which the needles are dropped,</li>
<li>the number of needles being used, i.e. <span class="math inline">\(B\)</span>,</li>
<li>number of experiments, which is needed to illustrate the convergence of the estimator,</li>
<li>the seed to allow “replicable” experiments. Then, we will need to create two output “tabs”. In the first one, we “print” the result(s) of the experiment and in the second one we will illustrate the convergence of the estimator. Finally, we will need a button to “run” a new experiment.</li>
</ol></li>
<li><strong>Step 3: Connecting frontend and backend</strong>: In this third step we will need to connect everything. Indeed, we will use the list <code>input</code> created by the widget define in the previous step to create the graphs to be displayed in the two output tabs. We will also need to “activate” (i.e. connect the execution of the approriated functions) the button to run a new experiment and update the “seed” after every new experiment.</li>
</ol>
<p>Eseentially, our approach show follow the chart presented below:</p>
<center>
<img src="images/buffon.png" />
</center>
<p>In the next sections, we will discuss in details how to program each step.</p>
<div id="step-1-backend" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Step 1: Backend</h3>
<p>Let us start with the function <code>cast_needle()</code>. This function has a single input, i.e. the width of the (square) plane on which the needle is casted and returns a <code>list</code> containing:</p>
<ul>
<li><code>$start</code>: the coordinates of the one end of the needle,</li>
<li><code>$end</code>: the coordinates of the other end of the needle,</li>
<li><code>$cross</code>: a binary variable to indicate if the needle intercepts a line.</li>
</ul>
<p>A possible implementation of this function is given below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cast_needle =<span class="st"> </span>function(<span class="dt">plane_width =</span> <span class="dv">20</span>){
  needle_length =<span class="st"> </span><span class="dv">1</span>
  available_range =<span class="st"> </span>plane_width/<span class="dv">2</span> -<span class="st"> </span>needle_length
  x_start =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">2</span>, -available_range, available_range)
  angle =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>*pi)
  x_end =<span class="st"> </span>needle_length*<span class="kw">c</span>(<span class="kw">cos</span>(angle), <span class="kw">sin</span>(angle)) +<span class="st"> </span>x_start
  cross =<span class="st"> </span><span class="kw">floor</span>(x_start[<span class="dv">2</span>]) !=<span class="st"> </span><span class="kw">floor</span>(x_end[<span class="dv">2</span>])
  out =<span class="st"> </span><span class="kw">list</span>(<span class="dt">start =</span> x_start, <span class="dt">end =</span> x_end, <span class="dt">cross =</span> cross)
  out
}</code></pre></div>
<p>Here is an example of the output of function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">needle =<span class="st"> </span><span class="kw">cast_needle</span>(<span class="dt">plane_width =</span> <span class="dv">4</span>)
needle</code></pre></div>
<pre><code>## $start
## [1]  0.3123407 -0.9171992
## 
## $end
## [1] -0.3690537 -1.6491156
## 
## $cross
## [1] TRUE</code></pre>
<p>and we could now for example provide the following graphical representation of this random cast:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="ot">NA</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> -<span class="dv">2</span>:<span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(needle$start[<span class="dv">1</span>], needle$end[<span class="dv">1</span>]), <span class="kw">c</span>(needle$start[<span class="dv">2</span>], needle$end[<span class="dv">2</span>]))</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-6-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>Next, we consider the function <code>buffon_experiment()</code>. This function is based on the previous function and contains the following inputs:</p>
<ul>
<li><code>B</code>: the number of needles being casted,</li>
<li><code>plane_width</code>: the width of the (square) plane on which the needles are casted,</li>
<li><code>seed</code>: the “seed” used by the random number generator (allows to replicate results),</li>
</ul>
<p>and returns a <code>list</code> containing:</p>
<ul>
<li><code>$start</code>: a <span class="math inline">\(B \times 2\)</span> matrix containing the coordinates of the one end of the <span class="math inline">\(B\)</span> needles,</li>
<li><code>$end</code>: a <span class="math inline">\(B \times 2\)</span> matrix containing the coordinates of the other end of the <span class="math inline">\(B\)</span> needles,</li>
<li><code>$cross</code>: a vector of length <span class="math inline">\(B\)</span> containing boolean variables to indicate the crossing the each needle,</li>
<li><code>$plane</code>: the width of the (square) plane.</li>
</ul>
<p>A possible implementation of this function is provided below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">buffon_experiment =<span class="st"> </span>function(<span class="dt">B =</span> <span class="dv">2084</span>, <span class="dt">plane_width =</span> <span class="dv">10</span>, <span class="dt">seed =</span> <span class="ot">NULL</span>){
  
  if (!<span class="kw">is.null</span>(seed)){
    <span class="kw">set.seed</span>(seed)
  }
  
  X_start =<span class="st"> </span>X_end =<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, B, <span class="dv">2</span>) 
  cross =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)
  
  for (i in <span class="dv">1</span>:B){
    inter =<span class="st"> </span><span class="kw">cast_needle</span>(<span class="dt">plane_width =</span> plane_width)
    X_start[i, ] =<span class="st"> </span>inter$start
    X_end[i, ] =<span class="st"> </span>inter$end
    cross[i] =<span class="st"> </span>inter$cross
  }
  
  out =<span class="st"> </span><span class="kw">list</span>(<span class="dt">start =</span> X_start, <span class="dt">end =</span> X_end, <span class="dt">cross =</span> cross, <span class="dt">plane =</span> plane_width)
  <span class="kw">class</span>(out) =<span class="st"> &quot;buffon_experiment&quot;</span>
  out
}</code></pre></div>
<p>For example, if we consider an experiment where one cast four needles we could obtain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">experiment =<span class="st"> </span><span class="kw">buffon_experiment</span>(<span class="dt">B =</span> <span class="dv">4</span>, <span class="dt">plane_width =</span> <span class="dv">4</span>)
experiment</code></pre></div>
<pre><code>## $start
##            [,1]       [,2]
## [1,] -0.5357408  0.7224472
## [2,] -0.5811448  0.1706289
## [3,]  0.3828416  0.3548458
## [4,] -0.9872323 -0.7416313
## 
## $end
##               [,1]      [,2]
## [1,] -1.0643616546 1.5713053
## [2,]  0.0002901955 0.9842218
## [3,] -0.4868643454 0.8484161
## [4,] -1.0046987030 0.2582162
## 
## $cross
## [1]  TRUE FALSE FALSE  TRUE
## 
## $plane
## [1] 4
## 
## attr(,&quot;class&quot;)
## [1] &quot;buffon_experiment&quot;</code></pre>
<p>which could be represented as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="ot">NA</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> -<span class="dv">2</span>:<span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
for (i in <span class="dv">1</span>:<span class="dv">4</span>){
  <span class="kw">lines</span>(<span class="kw">c</span>(experiment$start[i,<span class="dv">1</span>], experiment$end[i,<span class="dv">1</span>]), 
        <span class="kw">c</span>(experiment$start[i,<span class="dv">2</span>], experiment$end[i,<span class="dv">2</span>]))
}</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-9-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>We can now write a custom <code>plot()</code> function for the output of the function <code>buffon_experiment()</code>. This function will provide a way to visualize the experiment and will compute <span class="math inline">\(\hat{\pi}_B\)</span>, which will be shown in the title. A possible function is provided below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot.buffon_experiment =<span class="st"> </span>function(obj){
  cross =<span class="st"> </span>obj$cross
  X_start =<span class="st"> </span>obj$start
  X_end =<span class="st"> </span>obj$end
  B =<span class="st"> </span><span class="kw">length</span>(cross)
  cols =<span class="st"> </span><span class="kw">rev</span>(<span class="kw">hcl</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">375</span>, <span class="dt">length =</span> <span class="dv">3</span>), <span class="dt">l =</span> <span class="dv">65</span>, <span class="dt">c =</span> <span class="dv">100</span>)[<span class="dv">1</span>:<span class="dv">2</span>])
  
  titre_part1 =<span class="st"> &#39;Buffon</span><span class="ch">\&#39;</span><span class="st">s needle experiment  -  &#39;</span>
  titre_part2 =<span class="st"> &#39; = &#39;</span>
  pi_hat =<span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>/<span class="kw">mean</span>(obj$cross), <span class="dv">6</span>)
  
  titre =<span class="st"> </span><span class="kw">bquote</span>(.(titre_part1) ~<span class="st"> </span><span class="kw">hat</span>(pi)[B] ~<span class="st"> </span>.(titre_part2) ~<span class="st"> </span>.(pi_hat))
  
  <span class="kw">plot</span>(<span class="ot">NA</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(-obj$plane/<span class="dv">2</span>, obj$plane/<span class="dv">2</span>), 
       <span class="dt">ylim =</span> <span class="kw">c</span>(-obj$plan/<span class="dv">2</span>, obj$plan/<span class="dv">2</span>), 
       <span class="dt">main =</span> titre)
  <span class="kw">abline</span>(<span class="dt">h =</span> (-obj$plan):obj$plan, <span class="dt">lty =</span> <span class="dv">3</span>)
  
  for (i in <span class="dv">1</span>:B){
    <span class="kw">lines</span>(<span class="kw">c</span>(X_start[i,<span class="dv">1</span>], X_end[i,<span class="dv">1</span>]), <span class="kw">c</span>(X_start[i,<span class="dv">2</span>], X_end[i,<span class="dv">2</span>]), 
          <span class="dt">col =</span> cols[cross[i] +<span class="st"> </span><span class="dv">1</span>])
  }
}</code></pre></div>
<p>Therefore, we could now run the same experiment as Georges-Louis Leclerc fliging 2084 needles almost instanteously:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">experiment =<span class="st"> </span><span class="kw">buffon_experiment</span>(<span class="dt">B =</span> <span class="dv">2084</span>)
<span class="kw">plot</span>(experiment)</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Finally, we can consider the function <code>converge()</code>. Similarly to <code>buffon_experiment()</code>, the function <code>converge()</code> has the following inputs:</p>
<ul>
<li><code>B</code>: the number of needles being casted,</li>
<li><code>plane_width</code>: the width of the (square) plane on which the needles are casted,</li>
<li><code>seed</code>: the “seed” used by the random number generator (allows to replicate results),</li>
<li><code>M</code>: the number of experiments.</li>
</ul>
<p>The function returns the graph mentioned at the end of the previous section. A possible implementation of this function is provided below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">converge =<span class="st"> </span>function(<span class="dt">B =</span> <span class="dv">2084</span>, <span class="dt">plane_width =</span> <span class="dv">10</span>, <span class="dt">seed =</span> <span class="dv">1777</span>, <span class="dt">M =</span> <span class="dv">12</span>){
  
  if (B &lt;<span class="st"> </span><span class="dv">10</span>){
    <span class="kw">warning</span>(<span class="st">&quot;B was changed to 10&quot;</span>)
    B =<span class="st"> </span><span class="dv">10</span>
  }
  
  pi_hat =<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, B, M)
  trials =<span class="st"> </span><span class="dv">1</span>:B
  cols =<span class="st"> </span><span class="kw">rev</span>(<span class="kw">hcl</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">375</span>, <span class="dt">length =</span> (M<span class="dv">+1</span>)), 
                 <span class="dt">l =</span> <span class="dv">65</span>, <span class="dt">c =</span> <span class="dv">100</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)[<span class="dv">1</span>:M])
  <span class="kw">set.seed</span>(seed)
  
  for (i in <span class="dv">1</span>:M){
    cross =<span class="st"> </span><span class="kw">buffon_experiment</span>(<span class="dt">B =</span> B, <span class="dt">plane_width =</span> plane_width)$cross
    pi_hat[,i] =<span class="st"> </span><span class="dv">2</span>*trials/<span class="kw">cumsum</span>(cross)
  }
  
  <span class="kw">plot</span>(<span class="ot">NA</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,B), <span class="dt">ylim =</span> pi +<span class="st"> </span><span class="kw">c</span>(-<span class="dv">3</span>/<span class="dv">4</span>, <span class="dv">3</span>/<span class="dv">4</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;darkblue&quot;</span>,
       <span class="dt">ylab =</span> <span class="kw">bquote</span>(<span class="kw">hat</span>(pi)[j]),
       <span class="dt">xlab =</span> <span class="st">&quot;j&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Buffon</span><span class="ch">\&#39;</span><span class="st">s needle experiment&quot;</span>)
  <span class="kw">grid</span>()
  
  for (i in <span class="dv">1</span>:M){
    <span class="kw">lines</span>(trials, pi_hat[,i], <span class="dt">col =</span> cols[i])
  }
  
  <span class="kw">abline</span>(<span class="dt">h =</span> pi, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
}</code></pre></div>
<p>Therefore, if we were to repeat 20 times the original experiment of Georges-Louis Leclerc and compute <span class="math inline">\(\hat{\pi}_j\)</span> for each of them we would obtain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">converge</span>(<span class="dt">B =</span> <span class="dv">2084</span>, <span class="dt">M =</span> <span class="dv">20</span>, <span class="dt">seed =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="ds_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>which provides some illustrations of the convergence of the estimator.</p>
</div>
<div id="step-2-frontend" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Step 2: Frontend</h3>
<p>We start by constructing an “empty” shiny app, i.e.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define UI for application</span>
ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  
  <span class="co"># Application title</span>
  <span class="kw">titlePanel</span>(<span class="kw">h4</span>(<span class="st">&quot;Buffon</span><span class="ch">\&#39;</span><span class="st">s needle experiment - Inputs:&quot;</span>)),
  
  <span class="kw">sidebarLayout</span>(
    <span class="kw">sidebarPanel</span>(
      <span class="co"># Add inputs here!</span>
    ),
    
    <span class="kw">mainPanel</span>(
      <span class="kw">tabsetPanel</span>(
        <span class="co"># Add tabs here!</span>
      )
    )
  )
)

<span class="co"># Define server</span>
server &lt;-<span class="st"> </span>function(input, output) {
}

<span class="co"># Run the application </span>
<span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</code></pre></div>
<p>If you run this empty app you should obtain the result below:</p>
<center>
<img src="images/shiny_ui_part1.png" />
</center>
<p>We will start by adding the required input widgets by modifying the <code>ui</code> function as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define UI for application</span>
ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  
  <span class="co"># Application title</span>
  <span class="kw">titlePanel</span>(<span class="kw">h4</span>(<span class="st">&quot;Buffon</span><span class="ch">\&#39;</span><span class="st">s needle experiment - Inputs:&quot;</span>)),
  
  <span class="kw">sidebarLayout</span>(
    <span class="kw">sidebarPanel</span>(
      <span class="kw">numericInput</span>(<span class="st">&quot;plane&quot;</span>, <span class="st">&quot;Plane width:&quot;</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">100</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;Number of trials:&quot;</span>, <span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">10</span>^<span class="dv">6</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;Number of experiments:&quot;</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;Simulation seed&quot;</span>, <span class="dv">1777</span>, <span class="dv">1</span>, <span class="dv">1000000</span>),
      <span class="kw">actionButton</span>(<span class="st">&quot;cast&quot;</span>, <span class="st">&quot;Let&#39;s cast some needles!&quot;</span>, <span class="dt">icon =</span> <span class="kw">icon</span>(<span class="st">&quot;thumbs-up&quot;</span>))
    ),
    
    <span class="kw">mainPanel</span>(
      <span class="kw">tabsetPanel</span>(
        <span class="co"># Add tabs here!</span>
      )
    )
  )
)</code></pre></div>
<p>By running the update you should now obtain:</p>
<center>
<img src="images/shiny_ui_part2.png" />
</center>
<p>Next, we create two output tabs in which there will be the graphs previously mentioned. This can be done by modifying again the <code>ui</code>function as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define UI for application</span>
ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  
  <span class="co"># Application title</span>
  <span class="kw">titlePanel</span>(<span class="kw">h4</span>(<span class="st">&quot;Buffon</span><span class="ch">\&#39;</span><span class="st">s needle experiment - Inputs:&quot;</span>)),
  
  <span class="kw">sidebarLayout</span>(
    <span class="kw">sidebarPanel</span>(
      <span class="kw">numericInput</span>(<span class="st">&quot;plane&quot;</span>, <span class="st">&quot;Plane width:&quot;</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">100</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;Number of trials:&quot;</span>, <span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">10</span>^<span class="dv">6</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;Number of experiments:&quot;</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>),
      <span class="kw">numericInput</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;Simulation seed&quot;</span>, <span class="dv">1777</span>, <span class="dv">1</span>, <span class="dv">1000000</span>),
      <span class="kw">actionButton</span>(<span class="st">&quot;cast&quot;</span>, <span class="st">&quot;Let&#39;s cast some needles!&quot;</span>, <span class="dt">icon =</span> <span class="kw">icon</span>(<span class="st">&quot;thumbs-up&quot;</span>))
    ),
    
    <span class="kw">mainPanel</span>(
      <span class="kw">tabsetPanel</span>(
        <span class="kw">tabPanel</span>(<span class="st">&quot;Experiment&quot;</span>, <span class="kw">plotOutput</span>(<span class="st">&quot;exp&quot;</span>)),
        <span class="kw">tabPanel</span>(<span class="st">&quot;Convergence&quot;</span>, <span class="kw">plotOutput</span>(<span class="st">&quot;conv&quot;</span>))
      )
    )
  )
)</code></pre></div>
<p>The app should now look like:</p>
<center>
<img src="images/shiny_ui_part3.png" />
</center>
<p>At this point, we are done with the <code>ui</code> function and will modify the <code>server</code> in the next section.</p>
</div>
<div id="step-3-connecting-frontend-and-backend-1" class="section level3">
<h3><span class="header-section-number">7.7.3</span> Step 3: Connecting frontend and backend</h3>
<p>In this section, we will focus on the <code>server</code> function to produce the desired output. Let us start by “connecting” our output tabs defined in the <code>ui</code> function with the output in the server function. Since both outputs are graphs, we will use the function <code>renderPlot()</code> as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">server &lt;-<span class="st"> </span>function(input, output) {
  output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="co"># Add graph 1 here!</span>
  }, <span class="dt">height =</span> <span class="dv">620</span>)
  
  output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="co"># Add graph 2 here!</span>
  }, <span class="dt">height =</span> <span class="dv">620</span>)
}</code></pre></div>
<p>If you re-run the app at this point our changes will have no visible effect. Next, we will focus on the first graph based on the functions <code>buffon_experiment()</code> and <code>plot.buffon_experiment()</code>. The first thing we will need is to (re-)run the <code>buffon_experiment()</code> when the user click on the “action” button. This can be done by adding the following lines to the <code>server</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cast =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">buffon_experiment</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
                      <span class="dt">seed =</span> input$seed)
  })</code></pre></div>
<p>When this function is (re-)evaluated we want to update/create the first plot, which can be done by replacing this part of the <code>server</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="co"># Add graph 1 here!</span>
}, <span class="dt">height =</span> <span class="dv">620</span>)</code></pre></div>
<p>by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">plot</span>(<span class="kw">cast</span>())
}, <span class="dt">height =</span> <span class="dv">620</span>)</code></pre></div>
<p>Therefore, your <code>server</code> function should now be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">server &lt;-<span class="st"> </span>function(input, output) {
  
  <span class="co"># Fling some needles!</span>
  cast =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">buffon_experiment</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
                      <span class="dt">seed =</span> input$seed)
  })
  
  output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">plot</span>(<span class="kw">cast</span>())
  }, <span class="dt">height =</span> <span class="dv">620</span>)
  
  output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="co"># Add graph 2 here!</span>
  }, <span class="dt">height =</span> <span class="dv">620</span>)
}</code></pre></div>
<p>and when reloading the app you should now see:</p>
<center>
<img src="images/shiny_server_part1.png" />
</center>
<p>Similarly, we do the same thing for the second graph by adding the following lines to our <code>server</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">conv =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">converge</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plan, 
             <span class="dt">seed =</span> input$seed, <span class="dt">M =</span> input$M)
})</code></pre></div>
<p>and replacing</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="co"># Add graph 2 here!</span>
}, <span class="dt">height =</span> <span class="dv">620</span>)</code></pre></div>
<p>by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">conv</span>()
}, <span class="dt">height =</span> <span class="dv">620</span>)</code></pre></div>
<p>After these changes your <code>server</code> function should now be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">server &lt;-<span class="st"> </span>function(input, output) {
  
  <span class="co"># Fling some needles!</span>
  cast =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">buffon_experiment</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
                      <span class="dt">seed =</span> input$seed)
  })
  
  conv =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">converge</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
             <span class="dt">seed =</span> input$seed, <span class="dt">M =</span> input$M)
  })
  
  output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">plot</span>(<span class="kw">cast</span>())
  }, <span class="dt">height =</span> <span class="dv">620</span>)
  
  output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">conv</span>()
  }, <span class="dt">height =</span> <span class="dv">620</span>)
}</code></pre></div>
<p>NIAKETTE</p>
<p>and when reloading the app you should now see on the second tab:</p>
<center>
<img src="images/shiny_server_part2.png" />
</center>
<p>Our next step to update the seed everything the “action” button is pushed. To do so, we will first need to add an additional input to the <code>server</code> function called <code>session</code> which will allow us to <strong>dynmically</strong> update the input direct from the <code>server</code> function. This can be done as follows where everytime the user click on the “action” button a new seed is randomly generated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">observeEvent</span>(input$cast,{
    <span class="kw">updateNumericInput</span>(session, <span class="st">&quot;seed&quot;</span>, 
                       <span class="dt">value =</span> <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>^<span class="dv">4</span>)))
})</code></pre></div>
<p>Therefore, your final <code>server</code> function is now:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">server &lt;-<span class="st"> </span>function(input, output, session) {
  
  <span class="kw">observeEvent</span>(input$cast,{
    <span class="kw">updateNumericInput</span>(session, <span class="st">&quot;seed&quot;</span>, 
                       <span class="dt">value =</span> <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>^<span class="dv">4</span>)))
  })
  
  <span class="co"># Fling some needles!</span>
  cast =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">buffon_experiment</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
                      <span class="dt">seed =</span> input$seed)
  })
  
  conv =<span class="st"> </span><span class="kw">eventReactive</span>(input$cast, {
    <span class="kw">converge</span>(<span class="dt">B =</span> input$B, <span class="dt">plane_width =</span> input$plane, 
             <span class="dt">seed =</span> input$seed, <span class="dt">M =</span> input$M)
  })
  
  output$exp &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">plot</span>(<span class="kw">cast</span>())
  }, <span class="dt">height =</span> <span class="dv">620</span>)
  
  output$conv &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
    <span class="kw">conv</span>()
  }, <span class="dt">height =</span> <span class="dv">620</span>)
}</code></pre></div>
<p>and you will now see that the seed is now updated every time the “action” button is clicked on. The final version of the app we have just made can be found <a href="http://shiny.science.psu.edu/szg279/buffon/">here</a>.</p>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
    $("#hideclass1").hide();
    $("#hideclass2").hide();
    $("#hidebutton1").click(function(){
      $("#hideclass1").toggle();
    });
    $("#hidebutton2").click(function(){
      $("#hideclass2").toggle();
    });
</script>

</div>
</div>
</div>
<h3> Placeholder</h3>
<div id="refs" class="references">
<div id="ref-buffon1777essai">
<p>Georges-Louis Leclerc, Compte de Buffon. 1777. <em>Essai d’arithmétique Morale</em>. Histoire naturelle, générale, et particulière (supplément).</p>
</div>
<div id="ref-grimmett2001probability">
<p>Grimmett, Geoffrey, and David Stirzaker. 2001. <em>Probability and Random Processes</em>. Oxford university press.</p>
</div>
<div id="ref-dasgupta2008asymptotic">
<p>DasGupta, Anirban. 2008. <em>Asymptotic Theory of Statistics and Probability</em>. Springer Science &amp; Business Media.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="placeholder.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-shiny.Rmd",
"text": "Edit"
},
"download": ["ds.pdf", "ds.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
